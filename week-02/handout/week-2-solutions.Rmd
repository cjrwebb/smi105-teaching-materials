---
title: "Solutions, week 2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE)
```

## Loading packages


As always, the first thing I have to do is load the **tidyverse** package. Remember, as I have already installed the tidyverse package on this computer, I do not need to run **install.packages("tidyverse")**. I can go straight to the command below:

```{r, message = FALSE}
library(tidyverse)
```

## Loading data

Let's load the data from the web!

```{r, message = FALSE}
taylor <- read_csv("https://bit.ly/swifty-data")
fleet <- read_csv("https://bit.ly/fleetwood-mac-data")
monkeys <- read_csv("https://bit.ly/arctic-monkeys-data")
```

## Task - Taylor Swift

- Question 1 - How many of each of Taylor Swift’s songs are in each key? (C sharp, E, etc)

The first thing I would do is look at the data, to find a variable that describes the key. I can do this using some of the code from last week. For example, I can look at the names of each variable:

```{r, eval = FALSE}
names(taylor)
```

I can get a summary of the dataset.

```{r, eval = FALSE}
summary(taylor)
```

I can look at the dataset in a window.

```{r, eval = FALSE}
View(taylor)
```

And here’s a bit of code I use all the time! Don’t worry about understanding the mechanics of this code chunk. All you need to know is that it gives you the name of each variable and what type of variable it is (e.g. numeric, categorical, character etc.). You need to have tidyverse loaded to use it.

```{r, eval = FALSE}
taylor %>% 
  map_chr(class)
```

From this exploration of the data, I’ve found the right variable: key. I know this is the right one because it has a name which seems correct, and I’ve looked at the data and seen the observations contain letters that indicate keys (e.g. C#, D etc.). I could also read more about the variables at this link if I wanted to be sure.

So let’s make the graph.
```{r}
ggplot(data = taylor) +
  aes(x = key) +
  geom_bar()
```

- Question 2 - on which Taylor Swift albums are there the biggest number of tracks that are labelled as "explicit"?

The relevant variable in this question is explicit. But I also have to include album somewhere in my graph, as the question is asking for me to break it down by album.

There’s a few ways to do this. First I’ll show the most popular way in your submissions. And I think this is a great solution. So if you got it, well done!

```{r}
ggplot(data = taylor) +
  aes(x = explicit) +
  geom_bar() +
  facet_wrap(~album)
```


Below is another solution some people used. They used a technique we did last week, **geom_bar(position = "dodge")**. The album names aren’t readable, but we’ll get to that in another session.

```{r}
ggplot(data = taylor) +
  aes(x = album, fill = explicit) +
  geom_bar(position = "dodge")
```

- Question 3 - Which Taylor Swift album has the highest average danceability?

The relevant variables here are danceability and album. But there’s another key word, average. If you don’t calculate an average per album, you will most likely produce a bar plot that sums all the values for danceability per album. Instead we need to use some dplyr commands to produce an average of danceability per album. The code below does this using group_by and summarise.

```{r}
taylor %>% 
  group_by(album) %>% 
  summarise(mean_danceability = mean(danceability)) %>% 
  ggplot() +
  aes(x = album, y = mean_danceability) +
  geom_col()
```

### Task - do the same for another artist

- Question 4 - How many of each of Arctic Monkeys' songs are in each key? (C sharp, E, etc)

```{r}
ggplot(data = monkeys) +
  aes(x = key) +
  geom_bar()
```

- Question 5 - on which Arctic Monkeys' albums are there the biggest number of tracks that are labelled as "explicit"?

```{r}
ggplot(data = monkeys) +
  aes(x = explicit) +
  geom_bar() +
  facet_wrap(~album)
```

- Question 6 - Which Arctic Monkeys album has the highest average danceability?

```{r}
monkeys %>% 
  group_by(album) %>% 
  summarise(mean_danceability = mean(danceability)) %>% 
  ggplot() +
  aes(x = album, y = mean_danceability) +
  geom_col()
```


- Final question: show me something interesting!

There was a great mix here!


### Common errors in the submissions
- Not reading the question properly! Please submit a graph for each question, many submissions had graphs missing
- Not including the album variable in question 2. If you produced a bar chart with explicit on the x-axis, but didn’t include album in some way (e.g. as a facet, or a fill aesthetic), then this will count the number of explicit tracks across all albums
- Not using group_by and summarise to produce an average for question 3. If you don’t produce the average first, the height of the bar will be the sum of danceability values per album
- Using the wrong variables. Use the techniques at the top of this document to find the right variables. And read any documentation that accompanies a dataset
- Not connecting lines of code. Use the pipe %>% to connect your dplyr commands. Use the + sign to connect your ggplot commands. And format your lines of code as I have done here i.e. the first line of code starts immediately, then each line after that is indented